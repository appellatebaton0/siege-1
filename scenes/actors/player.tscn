[gd_scene load_steps=16 format=3 uid="uid://du1n8cl1rn58r"]

[ext_resource type="Script" uid="uid://dwh0yifrqxhcp" path="res://scripts/actor.gd" id="1_h5w3c"]
[ext_resource type="PackedScene" uid="uid://byojuvig761hd" path="res://scenes/components/cp_motion.tscn" id="2_0878f"]
[ext_resource type="Script" uid="uid://emk4mohj4ubh" path="res://scripts/components/motion_subcomponents/motion_states/cms_platformer.gd" id="3_dferu"]
[ext_resource type="PackedScene" uid="uid://b7m0l4xy8303h" path="res://scenes/components/cp_area.tscn" id="4_dferu"]
[ext_resource type="PackedScene" uid="uid://dnd4kisf8wjau" path="res://scenes/components/cp_sprite.tscn" id="4_t62v4"]
[ext_resource type="Script" uid="uid://b08hg2i6n1vvx" path="res://scripts/components/motion_subcomponents/mcp_knockback.gd" id="4_uqfkb"]
[ext_resource type="Script" uid="uid://cjxtdojc775br" path="res://scripts/components/area_components/acp_hurtbox.gd" id="5_t62v4"]
[ext_resource type="PackedScene" uid="uid://pq5hohriaemg" path="res://scenes/actors/guns/penny_gun.tscn" id="8_ypltb"]
[ext_resource type="Script" uid="uid://ds82ovpm2ilwi" path="res://scripts/dynamic_values/dv_property.gd" id="11_6xqls"]
[ext_resource type="Script" uid="uid://vflwvin64hae" path="res://scripts/dynamic_values/node/dn_node.gd" id="12_3hvrq"]
[ext_resource type="Script" uid="uid://cvvlcumbxn8pb" path="res://scripts/components/cp_health.gd" id="14_0878f"]
[ext_resource type="Script" uid="uid://bxjg885lu0c7y" path="res://scripts/components/elements/em_label.gd" id="15_dferu"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_tbgi4"]
size = Vector2(16, 24)

[sub_resource type="Gradient" id="Gradient_o6xl0"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_tipki"]
gradient = SubResource("Gradient_o6xl0")
width = 16
height = 24

[node name="Player" type="Node2D"]
script = ExtResource("1_h5w3c")
metadata/_custom_type_script = "uid://dwh0yifrqxhcp"

[node name="CP_Motion" parent="." instance=ExtResource("2_0878f")]
collision_layer = 2

[node name="PlatformerControl" type="Node" parent="CP_Motion"]
script = ExtResource("3_dferu")
jump_velocity = 250.0
floor_acceleration = 500.0
air_acceleration = 500.0
floor_friction = 500.0
air_friction = 500.0
gravity_multiplier = 0.7
metadata/_custom_type_script = "uid://emk4mohj4ubh"

[node name="Knockback" type="Node" parent="CP_Motion"]
script = ExtResource("4_uqfkb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="CP_Motion"]
shape = SubResource("RectangleShape2D_tbgi4")

[node name="CP_Area" parent="." instance=ExtResource("4_dferu")]
collision_layer = 2
collision_mask = 4

[node name="HurtboxAreaSubComponent" type="Node" parent="CP_Area"]
script = ExtResource("5_t62v4")
collision_mask = 4
metadata/_custom_type_script = "uid://cjxtdojc775br"

[node name="CollisionShape2D" type="CollisionShape2D" parent="CP_Area"]
shape = SubResource("RectangleShape2D_tbgi4")

[node name="CP_Sprite" parent="." instance=ExtResource("4_t62v4")]
texture = SubResource("GradientTexture2D_tipki")

[node name="PennyGun" parent="." instance=ExtResource("8_ypltb")]

[node name="HealthComponent" type="Node" parent="."]
script = ExtResource("14_0878f")
metadata/_custom_type_script = "uid://cvvlcumbxn8pb"

[node name="CanvasLayer" type="CanvasLayer" parent="."]
layer = 0

[node name="MarginContainer" type="MarginContainer" parent="CanvasLayer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 15
theme_override_constants/margin_top = 15
theme_override_constants/margin_right = 15
theme_override_constants/margin_bottom = 15

[node name="Label" type="Label" parent="CanvasLayer/MarginContainer" node_paths=PackedStringArray("values")]
layout_mode = 2
size_flags_horizontal = 0
size_flags_vertical = 0
theme_override_font_sizes/font_size = 30
text = "Budget"
script = ExtResource("15_dferu")
values = [NodePath("DynamicPropertyValue")]
text_format = "Remaining Budget: {0}"

[node name="DynamicPropertyValue" type="Node" parent="CanvasLayer/MarginContainer/Label"]
script = ExtResource("11_6xqls")
property = "health"
metadata/_custom_type_script = "uid://ds82ovpm2ilwi"

[node name="DynamicSingleNodeValue" type="Node" parent="CanvasLayer/MarginContainer/Label/DynamicPropertyValue" node_paths=PackedStringArray("node")]
script = ExtResource("12_3hvrq")
node = NodePath("../../../../../HealthComponent")
metadata/_custom_type_script = "uid://vflwvin64hae"

[connection signal="hurt" from="CP_Area/HurtboxAreaSubComponent" to="CP_Motion/Knockback" method="knockback"]
